[2023-05-07 19:40:39,045] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: riskthinking_ai_de.download_data manual__2023-05-07T19:40:33.112511+00:00 [queued]>
[2023-05-07 19:40:39,057] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: riskthinking_ai_de.download_data manual__2023-05-07T19:40:33.112511+00:00 [queued]>
[2023-05-07 19:40:39,058] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-05-07 19:40:39,059] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-05-07 19:40:39,060] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-05-07 19:40:39,079] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): download_data> on 2023-05-07 19:40:33.112511+00:00
[2023-05-07 19:40:39,089] {standard_task_runner.py:52} INFO - Started process 8120 to run task
[2023-05-07 19:40:39,093] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'riskthinking_ai_de', 'download_data', 'manual__2023-05-07T19:40:33.112511+00:00', '--job-id', '261', '--raw', '--subdir', 'DAGS_FOLDER/files/rt_ai_etl.py', '--cfg-path', '/tmp/tmp2zjaopjh', '--error-file', '/tmp/tmpwawq8us0']
[2023-05-07 19:40:39,095] {standard_task_runner.py:80} INFO - Job 261: Subtask download_data
[2023-05-07 19:40:39,171] {task_command.py:369} INFO - Running <TaskInstance: riskthinking_ai_de.download_data manual__2023-05-07T19:40:33.112511+00:00 [running]> on host 16ca7fe0df6c
[2023-05-07 19:40:39,281] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=riskthinking_ai_de
AIRFLOW_CTX_TASK_ID=download_data
AIRFLOW_CTX_EXECUTION_DATE=2023-05-07T19:40:33.112511+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-05-07T19:40:33.112511+00:00
[2023-05-07 19:40:39,283] {logging_mixin.py:115} INFO - Downloading data for A
[2023-05-07 19:40:39,286] {logging_mixin.py:115} INFO - Failed to create TzCache, reason: Error creating TzCache folder: '/home/***/.cache/py-yfinance' reason: [Errno 13] Permission denied: '/home/***/.cache/py-yfinance'
[2023-05-07 19:40:39,287] {logging_mixin.py:115} INFO - TzCache will not be used.
[2023-05-07 19:40:39,288] {logging_mixin.py:115} INFO - Tip: You can direct cache to use a different location with 'set_tz_cache_location(mylocation)'
[2023-05-07 19:40:39,818] {logging_mixin.py:115} INFO - [*********************100%***********************]  1 of 1 completed
[2023-05-07 19:40:39,824] {logging_mixin.py:115} INFO - Downloading data for AA
[2023-05-07 19:40:40,379] {logging_mixin.py:115} INFO - [*********************100%***********************]  1 of 1 completed
[2023-05-07 19:40:40,383] {logging_mixin.py:115} INFO - Downloading data for AAAU
[2023-05-07 19:40:40,804] {logging_mixin.py:115} INFO - [*********************100%***********************]  1 of 1 completed
[2023-05-07 19:40:40,808] {logging_mixin.py:115} INFO - Downloading data for AADR
[2023-05-07 19:40:41,278] {logging_mixin.py:115} INFO - [*********************100%***********************]  1 of 1 completed
[2023-05-07 19:40:41,291] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/decorators/base.py", line 179, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/files/rt_ai_etl.py", line 49, in download_data
    df_final.to_csv("/opt/airflow_local/data/stg/yfinance_data.csv")
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 3482, in to_csv
    storage_options=storage_options,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/formats/format.py", line 1105, in to_csv
    csv_formatter.save()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/formats/csvs.py", line 243, in save
    storage_options=self.storage_options,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/common.py", line 707, in get_handle
    newline="",
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow_local/data/stg/yfinance_data.csv'
[2023-05-07 19:40:41,321] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=riskthinking_ai_de, task_id=download_data, execution_date=20230507T194033, start_date=20230507T194039, end_date=20230507T194041
[2023-05-07 19:40:41,341] {standard_task_runner.py:97} ERROR - Failed to execute job 261 for task download_data ([Errno 2] No such file or directory: '/opt/airflow_local/data/stg/yfinance_data.csv'; 8120)
[2023-05-07 19:40:41,358] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-05-07 19:40:41,425] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
